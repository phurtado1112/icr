<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="Rep_Estado_Campanias_por_Asesor" language="groovy" pageWidth="612" pageHeight="792" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="95214df3-5e40-466a-ab7e-8c2433232b7b">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="SUBREPORT_DIR" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["C:\\xampp\\htdocs\\incaecrm\\administracion\\"]]></defaultValueExpression>
	</parameter>
	<queryString language="SQL">
		<![CDATA[SELECT
        `asignar`.`idasignar` AS `idasignar`,
        `campanias`.`idcampania` AS `idcampania`,
        `campanias`.`campania` AS `campania`,
        `campanias`.`terminada` AS `terminada`,
        `campanias`.`fechainicio` AS `fechainicio`,
        `campanias`.`fechafin` AS `fechafin`,
        `programas`.`idprograma` AS `idprograma`,
        `programas`.`programa` AS `programa`,
        `usuarios`.`idusuario` AS `idusuario`,
        `usuarios`.`nombre` AS `nombre`,
        SUM(IF((`clientes`.`idestado` = '1'), 1, 0)) AS `ATENDIDO`,
        SUM(IF((`clientes`.`idestado` = '0'), 1, 0)) AS `PENDIENTE`,
        COUNT(`clientes`.`idcliente`) AS `TOTAL`,
        ROUND(((SUM(IF((`clientes`.`idestado` = '1'), 1, 0)) * 100) / COUNT(`clientes`.`idcliente`)),
                1) AS `PROCENT`,
        SUM(IF((`transaccion`.`idtipificacion` = 16),
            1,
            0)) AS `CALIFICADO`,
        SUM(IF((`transaccion`.`idtipificacion` = 9),
            1,
            0)) AS `NOINTERESADO`,
        (SUM(IF((`transaccion`.`idtipificacion` = 18),
            1,
            0)) + SUM(IF((`transaccion`.`idtipificacion` = 21),
            1,
            0))) AS `OTROPROGRAMA`,
        (SUM(IF((`transaccion`.`idtipificacion` = 17),
            1,
            0)) + SUM(IF((`transaccion`.`idtipificacion` = 10),
            1,
            0))) AS `FALLIDA`,
        ((SUM(IF((`transaccion`.`idtipificacion` = 14),
            1,
            0)) + SUM(IF((`transaccion`.`idtipificacion` = 19),
            1,
            0))) + SUM(IF((`transaccion`.`idtipificacion` = 20),
            1,
            0))) AS `Otras`
    FROM
        ((((((`asignar`
        LEFT JOIN `campanias` ON ((`asignar`.`idcampania` = `campanias`.`idcampania`)))
        LEFT JOIN `programas` ON ((`campanias`.`idprograma` = `programas`.`idprograma`)))
        LEFT JOIN `usuarios` ON ((`asignar`.`idusuario` = `usuarios`.`idusuario`)))
        LEFT JOIN `clientes` ON ((`asignar`.`idasignar` = `clientes`.`idasignar`)))
        LEFT JOIN `cliente_transaccion` ON ((`clientes`.`idcliente` = `cliente_transaccion`.`idcliente`)))
        LEFT JOIN `transaccion` ON ((`cliente_transaccion`.`idtransaccion` = `transaccion`.`idtrasaccion`)))
    GROUP BY `asignar`.`idasignar`]]>
	</queryString>
	<field name="campania" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="fechainicio" class="java.sql.Date">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="fechafin" class="java.sql.Date">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="programa" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="nombre" class="java.lang.String">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="ATENDIDO" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="PENDIENTE" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="TOTAL" class="java.lang.Long">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="PROCENT" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="CALIFICADO" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="NOINTERESADO" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="OTROPROGRAMA" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<field name="FALLIDA" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[]]></fieldDescription>
	</field>
	<group name="nombre">
		<groupExpression><![CDATA[$F{nombre}]]></groupExpression>
	</group>
	<group name="programa">
		<groupExpression><![CDATA[$F{programa}]]></groupExpression>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="79" splitType="Stretch"/>
	</title>
	<pageHeader>
		<band height="35" splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band height="22" splitType="Stretch">
			<staticText>
				<reportElement x="3" y="0" width="100" height="20" uuid="3336de87-5116-4c5a-b7b7-faf451a860a1"/>
				<text><![CDATA[nombre]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="45" splitType="Stretch">
			<subreport>
				<reportElement x="0" y="0" width="200" height="41" uuid="bea05367-b800-478d-b3f7-3fef715fba0e"/>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR} + "Rep_Estado_Campanias_por_Asesor.jasper"]]></subreportExpression>
			</subreport>
			<textField>
				<reportElement x="3" y="3" width="100" height="20" uuid="683cc1ec-aff6-4116-a85c-9bb7c53efa15"/>
				<textFieldExpression><![CDATA[$F{nombre}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band height="45" splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band height="54" splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band height="42" splitType="Stretch"/>
	</summary>
</jasperReport>
